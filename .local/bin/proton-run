#!/usr/bin/env bash
set -euo pipefail

if [ $# -lt 1 ]; then
  echo "Usage: $0 <file.exe> [args...]" >&2
  exit 2
fi

export STEAM_COMPAT_CLIENT_INSTALL_PATH="${STEAM_COMPAT_CLIENT_INSTALL_PATH:-$HOME/.steam/steam}"
export STEAM_COMPAT_DATA_PATH="${STEAM_COMPAT_DATA_PATH:-$HOME/.proton}"


# Hard-set Proton path (quote the space)
PROTON_PATH="$HOME/.local/share/Steam/steamapps/common/Proton 10.0/proton"

if [ ! -f "$PROTON_PATH" ]; then
  echo "Proton not found at: $PROTON_PATH" >&2
  exit 1
fi

if [ ! -x "$PROTON_PATH" ]; then
  echo "Proton exists but is not executable; running with bash"
  exec bash "$PROTON_PATH" run "$@"
else
  exec "$PROTON_PATH" run "$@"
fi
