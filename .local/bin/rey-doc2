#!/usr/bin/env sh

SESSION_NAME="NAME"

tmux has-session -t $SESSION_NAME || {
  # Create session and first window (80/20 split + lf)
  tmux new-session -d -s $SESSION_NAME -n "Main Window"
  
  # Window 1: Split layout (80% top, 20% bottom)
  tmux split-window -v -t $SESSION_NAME:1 -p 20
  tmux send-keys -t $SESSION_NAME:1.1 'lf' C-m
  tmux select-pane -t $SESSION_NAME:1.1
  tmux split-window -h -t $SESSION_NAME:1
  tmux send-keys -t $SESSION_NAME:1.2 'lf' C-m

  # Window 2: Neovim in $HOME/.config with file picker
  tmux new-window -t $SESSION_NAME:2 -n "nvim" -c "$HOME/.config"
  tmux send-keys -t $SESSION_NAME:2 "nvim -c 'lua require(\"mini.pick\").builtin.files()'" C-m

  # Focus Window 1 and attach
  tmux select-window -t $SESSION_NAME:1
  tmux attach-session -t $SESSION_NAME
}

# Attach if session exists
tmux attach-session -t $SESSION_NAME
