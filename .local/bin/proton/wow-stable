#!/usr/bin/env bash
# wow-stable.sh

export WINEPREFIX="$HOME/.wine-wow"
export WINEARCH=win64

# Critical: Disable problematic CPU optimizations
export DXVK_ASYNC=0  # Disable async for stability
export DXVK_STATE_CACHE=1
export DXVK_HUD=0

# Disable threaded optimizations that might cause illegal instructions
export __GL_THREADED_OPTIMIZATIONS=0
export mesa_glthread=false

# Use simpler graphics backend
export MESA_GL_VERSION_OVERRIDE=3.0
export MESA_GLSL_VERSION_OVERRIDE=130

# Mouse fix
export SDL_VIDEO_X11_DGAMOUSE=0

# Suppress Wine debug output but keep errors
export WINEDEBUG=fixme-all,err-all

echo "ðŸŽ® Launching WoW with stability fixes..."
wine "$HOME/Games/Frostmourne/Wow.exe" -opengl -windowed -console $@
