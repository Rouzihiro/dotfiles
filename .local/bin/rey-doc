#!/usr/bin/env sh

SESSION_NAME="REY"

tmux has-session -t $SESSION_NAME 2>/dev/null || {
  # Create session and first window
  tmux new-session -d -s $SESSION_NAME -n "Main Window"

  # Run lf in the first (full) pane
  tmux send-keys -t $SESSION_NAME:1.1 'lf' C-m

  # Split off a bottom pane (20%) for shell
  tmux split-window -v -t $SESSION_NAME:1 -p 20

  # Focus back on the top pane (lf)
  tmux select-pane -t $SESSION_NAME:1.1

  # Window 2: Neovim in ~/.config with file picker
  tmux new-window -t $SESSION_NAME:2 -n "nvim" -c "$HOME/dotfiles/.config"
  tmux send-keys -t $SESSION_NAME:2 "nvim -c 'lua require(\"mini.pick\").builtin.files()'" C-m

  # Focus back on Window 1
  tmux select-window -t $SESSION_NAME:1
}

# Attach
tmux attach-session -t $SESSION_NAME
