cat > hide-empty-tags.diff << 'EOF'
--- a/dwm.c
+++ b/dwm.c
@@ -744,7 +744,18 @@
 drawbar(Monitor *m)
 {
 	int x, w, sw = 0;
-	int i, occ = 0, urg = 0;
+	int i, occ = 0, urg = 0, is_tag_empty = 1;
+	Client *c;
+
+	/* Calculate occupied tags */
+	for (c = m->clients; c; c = c->next) {
+		occ |= c->tags;
+		if (c->isurgent)
+			urg |= c->tags;
+	}
+
+	x = 0;
+	for (i = 0; i < LENGTH(tags); i++) {
+		/* Check if tag is empty (has no windows) */
+		is_tag_empty = 1;
+		for (c = m->clients; c; c = c->next) {
+			if (c->tags & (1 << i)) {
+				is_tag_empty = 0;
+				break;
+			}
+		}
+		
+		/* Skip empty tags unless they're selected */
+		if (is_tag_empty && !(m->tagset[m->seltags] & 1 << i))
+			continue;
+		
 		w = TEXTW(tags[i]);
 		drw_setscheme(drw, scheme[m->tagset[m->seltags] & 1 << i ? SchemeSel : SchemeNorm]);
 		drw_text(drw, x, 0, w, bh, lrpad / 2, tags[i], urg & 1 << i);
EOF
